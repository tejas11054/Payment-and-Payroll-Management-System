<!-- forgot-password.html -->
<div class="fp-wrapper" [class.dark-mode]="isDarkMode">
  
  <!-- Animated Background Shapes -->
  <div class="shape shape1"></div>
  <div class="shape shape2"></div>
  <div class="shape shape3"></div>


  
  <div class="fp-container">
    
    <!-- Header -->
    <div class="fp-header">
      <a routerLink="/" class="logo">Pay<span class="logo-accent">Roll</span></a>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- STEP 1: EMAIL INPUT -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <ng-container *ngIf="currentStep === 'email'">
      <div class="step-indicator">
        <span class="step active">1</span>
        <span class="step">2</span>
        <span class="step">3</span>
      </div>

      <h2>ğŸ” Forgot Password?</h2>
      <p class="subtitle">No worries, we'll send you a reset code.</p>

      <form [formGroup]="emailForm" (ngSubmit)="onRequestOTP()" novalidate>
        <div class="form-group">
          <label for="email">ğŸ“§ Email Address</label>
          <input 
            id="email" 
            type="email" 
            formControlName="email" 
            placeholder="Enter your registered email"
            [class.error]="emailForm.get('email')?.invalid && emailForm.get('email')?.touched">
        </div>

        <button type="submit" class="btn-primary" [disabled]="isLoading">
          <span *ngIf="!isLoading">Send Reset Code</span>
          <span *ngIf="isLoading">Sending...</span>
        </button>
      </form>
    </ng-container>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- STEP 2: OTP VERIFICATION -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <ng-container *ngIf="currentStep === 'otp'">
      <div class="step-indicator">
        <span class="step completed">âœ“</span>
        <span class="step active">2</span>
        <span class="step">3</span>
      </div>

      <h2>ğŸ”¢ Enter Verification Code</h2>
      <p class="subtitle">We've sent a 5-digit code to <strong>{{ userEmail }}</strong></p>

      <form [formGroup]="otpForm" (ngSubmit)="onVerifyOTP()" novalidate>
        <div class="form-group">
          <label for="otp">ğŸ” OTP Code</label>
          <div class="otp-inputs">
            <input id="otp1" type="text" formControlName="otp1" maxlength="1" (keyup)="onKeyUp($event, 'otp2')" />
            <input id="otp2" type="text" formControlName="otp2" maxlength="1" (keyup)="onKeyUp($event, 'otp3', 'otp1')" />
            <input id="otp3" type="text" formControlName="otp3" maxlength="1" (keyup)="onKeyUp($event, 'otp4', 'otp2')" />
            <input id="otp4" type="text" formControlName="otp4" maxlength="1" (keyup)="onKeyUp($event, 'otp5', 'otp3')" />
            <input id="otp5" type="text" formControlName="otp5" maxlength="1" (keyup)="onKeyUp($event, undefined, 'otp4')" />
          </div>
        </div>

        <button type="submit" class="btn-primary" [disabled]="isLoading">
          <span *ngIf="!isLoading">Verify Code</span>
          <span *ngIf="isLoading">Verifying...</span>
        </button>

        <button type="button" class="btn-secondary" (click)="resendOTP()" [disabled]="isLoading">
          ğŸ“¤ Resend Code
        </button>

        <button type="button" class="btn-text" (click)="goBackToEmail()">
          â† Change Email
        </button>
      </form>
    </ng-container>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- STEP 3: NEW PASSWORD -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <ng-container *ngIf="currentStep === 'password'">
      <div class="step-indicator">
        <span class="step completed">âœ“</span>
        <span class="step completed">âœ“</span>
        <span class="step active">3</span>
      </div>

      <h2>ğŸ”‘ Set New Password</h2>
      <p class="subtitle">Choose a strong password for your account</p>

      <form [formGroup]="passwordForm" (ngSubmit)="onResetPassword()" novalidate>
        <div class="form-group">
          <label for="newPassword">ğŸ”’ New Password</label>
          <input 
            id="newPassword" 
            type="password" 
            formControlName="newPassword" 
            placeholder="Enter new password (min 6 characters)"
            [class.error]="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched">
        </div>

        <div class="form-group">
          <label for="confirmPassword">âœ… Confirm Password</label>
          <input 
            id="confirmPassword" 
            type="password" 
            formControlName="confirmPassword" 
            placeholder="Re-enter new password"
            [class.error]="passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched">
        </div>

        <div class="error-message" *ngIf="passwordForm.errors?.['passwordMismatch'] && passwordForm.get('confirmPassword')?.touched">
          âš ï¸ Passwords do not match
        </div>

        <button type="submit" class="btn-primary" [disabled]="isLoading">
          <span *ngIf="!isLoading">Reset Password</span>
          <span *ngIf="isLoading">Resetting...</span>
        </button>

        <button type="button" class="btn-text" (click)="goBackToOTP()">
          â† Back
        </button>
      </form>
    </ng-container>

    <!-- Back to Login -->
    <div class="back-to-login">
      <a routerLink="/login">â† Back to Login</a>
    </div>

  </div>
</div>

